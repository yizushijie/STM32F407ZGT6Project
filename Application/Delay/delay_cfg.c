#include "delay_cfg.h"
///////////////////////////////////////////////////////////////////////////////
//////函	   数： void Delay_us(UINT32_T us)
//////功	   能： 微妙的延时函数
//////输入参数: 延时时间
//////输出参数: 无
//////说	   明：
//////////////////////////////////////////////////////////////////////////////
void Delay_us(UINT32_T us)
{
	DelayN_us(us);
}

///////////////////////////////////////////////////////////////////////////////
//////函	   数： void Delay_ms(UINT32_T ms)
//////功	   能： 毫秒的延时函数
//////输入参数: 延时时间
//////输出参数: 无
//////说	   明：
//////////////////////////////////////////////////////////////////////////////
void Delay_ms(UINT32_T ms)
{
	if (ms != 0)
	{
		if (SysTickTask_1msIncTick() == OK_0)
		{
			//---等待延时到达
			//SysTickTask_IRQDecTick(ms);
			SysTickTask_DecTick(ms);
		}
		else
		{
			DelayN_ms(ms);
		}
	}
}

///////////////////////////////////////////////////////////////////////////////
//////函	   数： void Delay_s(UINT32_T ms)
//////功	   能： 秒延时
//////输入参数: 延时时间
//////输出参数: 无
//////说	   明：
//////////////////////////////////////////////////////////////////////////////
void Delay_s(UINT32_T s)
{
	if (s != 0)
	{
		while (s--)
		{
			Delay_ms(1000);
			WDT_RESET();
		}
	}
}

///////////////////////////////////////////////////////////////////////////////
//////函	   数： void DelayN_us(UINT32_T us)
//////功	   能： 查询的方式，使用系统滴答定时器的作为延时计算
//////输入参数: 微妙的延时时间
//////输出参数: 无
//////说	   明：
//////////////////////////////////////////////////////////////////////////////
void DelayN_us(UINT32_T us)
{
	if (us != 0)
	{
		Delay_ms(us / 1000);
		//---等待时间的到达
		SysTickTask_WaitusTick(us%1000);
	}
}
///////////////////////////////////////////////////////////////////////////////
//////函	   数： void DelayN_ms(UINT32_T ms)
//////功	   能： 查询的方式，使用系统滴答定时器的作为延时计算
//////输入参数: 毫秒的延时时间
//////输出参数:
//////说	   明：
//////////////////////////////////////////////////////////////////////////////
void DelayN_ms(UINT32_T ms)
{
	if (ms != 0)
	{
		while (ms--)
		{
			DelayN_us(1000);
			WDT_RESET();
		}
	}
}

///////////////////////////////////////////////////////////////////////////////
//////函	   数： void DelayN_s(UINT32_T s)
//////功	   能： 查询的方式，使用系统滴答定时器的作为延时计算
//////输入参数: 秒的延时时间
//////输出参数:
//////说	   明：
//////////////////////////////////////////////////////////////////////////////
void DelayN_s(UINT32_T s)
{
	if (s != 0)
	{
		while (s--)
		{
			DelayN_ms(1000);
		}
	}
}

///////////////////////////////////////////////////////////////////////////////
//////函	   数： void Delay_nop(UINT32_T nop)
//////功	   能： 系统时钟的延时
//////输入参数: 系统时钟延时的个数
//////输出参数: 无
//////说	   明：
//////////////////////////////////////////////////////////////////////////////
void Delay_nop(UINT32_T nop)
{
	if (nop != 0)
	{
		//---系统中断关闭
		CLI();
		while (nop--)
		{
			__asm("NOP");
		}

		//---系统中断打开
		SEI();
	}
}

///////////////////////////////////////////////////////////////////////////////
//////函		数：
//////功		能：
//////输入参数:
//////输出参数:
//////说		明：
//////////////////////////////////////////////////////////////////////////////
void Delay_ClkNop(UINT32_T clkNum)
{
	//__asm("subs  r0, #1");
	//__asm("bne.n Delay_ClkNop");
	//__asm("bx    lr");
	while(clkNum--);
}

///////////////////////////////////////////////////////////////////////////////
//////函	   数： void Delay_1us(UINT32_T us)
//////功	   能： 使用nop延时函数，进行1us的整数倍的延时时间的计算
//////输入参数: us延时的个数
//////输出参数: 无
//////说	   明：
//////////////////////////////////////////////////////////////////////////////
void Delay_1us(UINT32_T us)
{
	UINT32_T i = 0;
	if (us != 0)
	{
		for (i = 0; i < us; i++)
		{
			Delay_nop((SYS_CLOCK_MHZ - 1));
		}
	}
}